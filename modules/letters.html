<h2>Generate Letter Prompt</h2>

<div class="form-group">
    <label for="clientSelect">Select Client:</label>
    <select id="clientSelect" onchange="loadClientInfo()">
        <option value="">-- Select a Client --</option>
    </select>
</div>

<div id="clientInfoSection" style="display: none;">
    <div class="client-info">
        <h3>Client Information</h3>
        <div class="info-grid" id="clientInfoGrid"></div>
    </div>

    <div class="letter-history">
        <h4>Letter History</h4>
        <div id="letterHistoryList"></div>
    </div>

    <div class="form-group">
        <label for="clientPrefix">Client Prefix:</label>
        <select id="clientPrefix">
            <option value="">-- Select Prefix --</option>
            <option value="Mr">Mr</option>
            <option value="Mrs">Mrs</option>
            <option value="Ms">Ms</option>
            <option value="Miss">Miss</option>
            <option value="Dr">Dr</option>
        </select>
    </div>

    <div class="form-group">
        <label for="letterType">Letter Type:</label>
        <select id="letterType" onchange="updateLetterFields()">
            <option value="">-- Select Letter Type --</option>
            <option value="CCL">Client Care Letter (CCL)</option>
            <option value="Mention">Mention Letter</option>
            <option value="Final">Final Letter</option>
            <option value="FeeReestimate">Fee Re-estimate Letter</option>
        </select>
    </div>

    <div id="dynamicFields"></div>

    <div class="cdr-checkbox" id="cdrForLetterSection" style="display: none;">
        <div class="checkbox-item">
            <input type="checkbox" id="generateCDRWithLetter" onchange="toggleCDRFields()">
            <label for="generateCDRWithLetter">Generate CDR for next appearance?</label>
        </div>

        <div id="cdrFieldsInLetter" style="display: none; margin-top: 15px;">
            <h4>CDR Details (will auto-populate from letter data)</h4>
            <div class="form-group">
                <label for="nextCourtDate">Next Court Date:</label>
                <input type="date" id="nextCourtDate">
            </div>
            <div class="form-group">
                <label for="letterCDRReason">CDR Reason:</label>
                <select id="letterCDRReason">
                    <option value="">-- Select Reason --</option>
                    <option value="Mention">Mention</option>
                    <option value="Mention (Brief Reply)">Mention (Brief Reply)</option>
                    <option value="Sentence">Sentence</option>
                    <option value="Hearing">Hearing</option>
                    <option value="Compliance Mention">Compliance Mention</option>
                    <option value="Brief Status">Brief Status</option>
                    <option value="Charge Certification">Charge Certification</option>
                    <option value="Committal">Committal</option>
                    <option value="Arraignment">Arraignment</option>
                    <option value="Return of Subpoena">Return of Subpoena</option>
                </select>
            </div>

            <div class="form-group">
                <label>Allocate To:</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="letter_allocate_AAG" value="AAG">
                        <label for="letter_allocate_AAG">AAG</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="letter_allocate_RHH" value="RHH">
                        <label for="letter_allocate_RHH">RHH</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="letter_allocate_SRS" value="SRS">
                        <label for="letter_allocate_SRS">SRS</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="letter_allocate_BJB" value="BJB">
                        <label for="letter_allocate_BJB">BJB</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="letter_allocate_NKM" value="NKM">
                        <label for="letter_allocate_NKM">NKM</label>
                    </div>
                </div>
            </div>

            <div class="checkbox-item">
                <input type="checkbox" id="letterCDRClientExcused">
                <label for="letterCDRClientExcused">Client Excused</label>
            </div>
        </div>
    </div>

    <div class="form-actions" style="margin-top: 30px;">
        <button class="btn btn-primary" onclick="generatePrompt()">Generate Claude Prompt</button>
        <button class="btn btn-success" onclick="copyPrompt()">Copy to Clipboard</button>
        <button class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
        <button class="btn btn-success" onclick="sendToZapier()">Send to Zapier</button>
        <button class="btn btn-primary" onclick="updateExcelRecord()">Update Excel Record</button>
    </div>

    <div id="promptOutput" class="output-box" style="display: none;"></div>
    <div id="zapierStatus" style="display: none; margin-top: 10px; padding: 10px; border-radius: 4px;"></div>
</div>
